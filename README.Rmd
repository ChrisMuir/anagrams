---
output: 
  github_document: default
  html_document: default
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# anagrams

[![Travis-CI Build Status](https://travis-ci.org/ChrisMuir/anagrams.svg?branch=master)](https://travis-ci.org/ChrisMuir/anagrams)

`anagrams` is a super simple R package providing a function for comparing character vectors and determining if strings are [anagrams](https://en.wikipedia.org/wiki/Anagram) of one another. The project was inspired by [this](http://www.programmingr.com/content/simple-anagram-finder-using-r/) blog post on finding anagrams in R. The package uses C++ and [Rcpp](https://CRAN.R-project.org/package=Rcpp) for speed.

## Installation

Install from github with:
```{r eval = FALSE}
# install.packages("devtools")
devtools::install_github("ChrisMuir/anagrams")
```

## Example Usage

The exported function `is_anagram` takes as input a string and a character vector, and returns a logical vector with length equal to that of the character vector.

```{r}
library(anagrams)

# Test for anagrams that are the same length as the input string.
is_anagram("stac", c("cats are great", "tacs", "frogs", "cats", "ts"))

# Set arg "any_len" to TRUE to test for anagrams that are any length (either same length or sub-string).
is_anagram("stac", c("cats are great", "tacs", "frogs", "cats", "ts"), any_len = TRUE)

# Use arg "ignore_spaces" to make anagram searching insensitive to spaces.
is_anagram("s t a c", c("cats are great", "t acs", "frogs", "ca   ts", "ts"), ignore_spaces = TRUE)

# Use arg "ignore_case" to make anagram searching insensitive to lower/upper case.
is_anagram("STAc", c("catS are great", "tacs", "frogs", "CaTS", "ts"), ignore_case = TRUE)
```

## Benchmarks

Let's create a simple, pure R version of `is_anagram` that searches for same length anagrams, and compare speeds.
```{r}
r_is_anagram <- function(string, terms) {
  # Split both inputs into char vectors of individual chars.
  string <- unlist(strsplit(string, "", fixed = TRUE))
  terms <- strsplit(terms, "", fixed = TRUE)
  
  # Get number of chars of input "string"
  str_len <- length(string)
  
  vapply(terms, function(x) {
    if (length(x) != str_len) {
      return(FALSE)
    }
    if (identical(x, string)) {
      return(TRUE)
    }
    
    # Check if all chars of "string" appear in those of x.
    all(string %in% x)
  }, logical(1))
}

# Test to make sure its output is identical to that of pkg function is_anagram.
identical(
  r_is_anagram("stac", c("cats are great", "tacs", "frogs", "cats", "ts")), 
  is_anagram("stac", c("cats are great", "tacs", "frogs", "cats", "ts"))
)
```

Also create a quick convenience function for generating random strings.

```{r}
get_rand_str <- function(n, str_len) {
  vapply(seq_len(n), function(x) {
    paste(letters[sample(length(letters), str_len, replace = TRUE)], collapse = "")
  }, character(1))
}
```

Now we'll compare speeds.

```{r}
library(microbenchmark)

# Test in which each element is shorter than the input string.
test_vect <- get_rand_str(n = 100000, str_len = 3)
microbenchmark(
  rfn = r_is_anagram("cats", test_vect), 
  cpp = is_anagram("cats", test_vect), 
  times = 100
)


# Test in which each element is the same length as the input string.
test_vect <- get_rand_str(n = 100000, str_len = 4)
microbenchmark(
  rfn = r_is_anagram("cats", test_vect), 
  cpp = is_anagram("cats", test_vect), 
  times = 100
)


# Test in which each element is an anagram of the input string.
test_vect <- rep("tacs", 100000)
microbenchmark(
  rfn = r_is_anagram("cats", test_vect), 
  cpp = is_anagram("cats", test_vect), 
  times = 100
)
```
